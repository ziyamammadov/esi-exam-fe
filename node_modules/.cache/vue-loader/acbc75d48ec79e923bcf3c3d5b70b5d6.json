{"remainingRequest":"/Users/ziya/Development/Other/esi-project-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ziya/Development/Other/esi-project-vue/src/components/BookList.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/ziya/Development/Other/esi-project-vue/src/components/BookList.vue","mtime":1653256897344},{"path":"/Users/ziya/Development/Other/esi-project-vue/node_modules/cache-loader/dist/cjs.js","mtime":1652517625200},{"path":"/Users/ziya/Development/Other/esi-project-vue/node_modules/babel-loader/lib/index.js","mtime":1652517626201},{"path":"/Users/ziya/Development/Other/esi-project-vue/node_modules/ts-loader/index.js","mtime":1652517615040},{"path":"/Users/ziya/Development/Other/esi-project-vue/node_modules/cache-loader/dist/cjs.js","mtime":1652517625200},{"path":"/Users/ziya/Development/Other/esi-project-vue/node_modules/vue-loader/lib/index.js","mtime":1652517614138}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHtDb21wb25lbnQsIFZ1ZX0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7CmltcG9ydCBCb29rU2VydmljZSBmcm9tICJAL3NlcnZpY2VzL0Jvb2tTZXJ2aWNlIjsKaW1wb3J0IHtuYW1lc3BhY2V9IGZyb20gInZ1ZXgtY2xhc3MiOwppbXBvcnQgQm9ycm93aW5nU2VydmljZSBmcm9tICJAL3NlcnZpY2VzL0JvcnJvd2luZ1NlcnZpY2UiOwoKY29uc3QgQXV0aCA9IG5hbWVzcGFjZSgiQXV0aCIpOwoKY2xhc3MgQm9va0R0byB7CgogIGlkOiBudW1iZXI7CiAgYXV0aG9yOiBzdHJpbmc7CiAgdGl0bGU6IHN0cmluZzsKICB5ZWFyOiBzdHJpbmc7CiAgc3RhdHVzOiBzdHJpbmc7CiAgc2VsZWN0ZWRTdGF0dXM6IHN0cmluZzsKICBsYW5ndWFnZTogc3RyaW5nOwogIGNhdGVnb3JpZXM6IHN0cmluZzsKCiAgY29uc3RydWN0b3IoCiAgICAgIGlkOiBudW1iZXIsCiAgICAgIGF1dGhvcjogc3RyaW5nLAogICAgICB0aXRsZTogc3RyaW5nLAogICAgICB5ZWFyOiBzdHJpbmcsCiAgICAgIHN0YXR1czogc3RyaW5nLAogICAgICBzZWxlY3RlZFN0YXR1czogc3RyaW5nLAogICAgICBsYW5ndWFnZTogc3RyaW5nLAogICAgICBjYXRlZ29yaWVzOiBzdHJpbmcKICApIHsKICAgIHRoaXMuaWQgPSBpZAogICAgdGhpcy5hdXRob3IgPSBhdXRob3IKICAgIHRoaXMudGl0bGUgPSB0aXRsZQogICAgdGhpcy55ZWFyID0geWVhcgogICAgdGhpcy5zdGF0dXMgPSBzdGF0dXMKICAgIHRoaXMuc2VsZWN0ZWRTdGF0dXMgPSBzZWxlY3RlZFN0YXR1cwogICAgdGhpcy5sYW5ndWFnZSA9IGxhbmd1YWdlCiAgICB0aGlzLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzCiAgfQp9CgpAQ29tcG9uZW50CmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhvbWUgZXh0ZW5kcyBWdWUgewogIEBBdXRoLlN0YXRlKCJ1c2VyIikKICBwcml2YXRlIGN1cnJlbnRVc2VyITogYW55OwogIHByaXZhdGUgY29udGVudDogQm9va0R0b1tdID0gW107CiAgcHJpdmF0ZSBlcnJvciA9IG51bGw7CiAgcHJpdmF0ZSBzZWFyY2hLZXkgPSAiIjsKCiAgbW91bnRlZCgpIHsKICAgIGlmICghdGhpcy5jdXJyZW50VXNlcikgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2xvZ2luIik7CiAgICB9CiAgICB0aGlzLmxvYWRCb29rcygpOwogIH0KCiAgbG9hZEJvb2tzKCkgewogICAgQm9va1NlcnZpY2Uuc2VhcmNoQm9va3ModGhpcy5zZWFyY2hLZXksIDIwLCAwKS50aGVuKAogICAgICAgIChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5jb250ZW50ID0gcmVzcG9uc2UuZGF0YS5jb250ZW50OwogICAgICAgIH0sCiAgICAgICAgKGVycm9yKSA9PiB0aGlzLmV4dHJhY3RFcnJvck1lc3NhZ2UoZXJyb3IpCiAgICApOwogIH0KCiAgaXNMaWJyYXJpYW4oKTogYm9vbGVhbiB7CiAgICBpZiAodGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLmF1dGhvcml0aWVzKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRVc2VyLmF1dGhvcml0aWVzLmluY2x1ZGVzKCJMSUJSQVJJQU4iKTsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CgogIGJvcnJvdyhib29rSWQ6IG51bWJlcikgewogICAgQm9ycm93aW5nU2VydmljZS5ib3Jyb3coewogICAgICBib29rSWQ6IGJvb2tJZAogICAgfSkudGhlbigKICAgICAgICAocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMubG9hZEJvb2tzKCk7CiAgICAgICAgfSwKICAgICAgICAoZXJyb3IpID0+IHRoaXMuZXh0cmFjdEVycm9yTWVzc2FnZShlcnJvcikKICAgICk7CiAgfQoKICByZWxlYXNlKGJvb2tJZDogbnVtYmVyKSB7CiAgICBCb3Jyb3dpbmdTZXJ2aWNlLnJlbGVhc2UoewogICAgICBib29rSWQ6IGJvb2tJZAogICAgfSkudGhlbigKICAgICAgICAocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMubG9hZEJvb2tzKCk7CiAgICAgICAgfSwKICAgICAgICAoZXJyb3IpID0+IHRoaXMuZXh0cmFjdEVycm9yTWVzc2FnZShlcnJvcikKICAgICk7CiAgfQoKICBwcml2YXRlIGV4dHJhY3RFcnJvck1lc3NhZ2UoZXJyb3I6IGFueSkgewogICAgdGhpcy5lcnJvciA9CiAgICAgICAgKGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLmRhdGEpIHx8CiAgICAgICAgZXJyb3IubWVzc2FnZSB8fAogICAgICAgIGVycm9yLnRvU3RyaW5nKCk7CiAgfQp9Cg=="},{"version":3,"sources":["BookList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BookList.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"container\">\n    <header class=\"jumbotron\">\n      <h3>List of all books</h3>\n      <div class=\"input-group\">\n        <input @keyup.enter=\"loadBooks()\" type=\"text\" class=\"form-control\" placeholder=\"Search\" v-model=\"searchKey\">\n        <button @click=\"loadBooks()\" class=\"input-group-text\">&#x1F50E</button>\n      </div>\n    </header>\n    <div id=\"books\">\n      <div>\n        <router-link :to=\"'books/create'\" v-if=\"isLibrarian()\">\n          <button class=\"btn btn-primary btn-block mb-3\">\n            ADD NEW BOOK\n          </button>\n        </router-link>\n      </div>\n      <div>\n\n      </div>\n      <table id=\"booksTable\" class=\"table\">\n        <thead v-if=\"content\">\n        <tr>\n          <th v-for=\"(value, key) in content[0]\" :key=\"key\">\n            {{ key }}\n          </th>\n        </tr>\n        </thead>\n        <p v-else>{{ error }}</p>\n        <tbody>\n        <tr v-for=\"book in content\" :key=\"book.id\">\n          <td v-for=\"field in book\" :key=\"field\">\n            {{ typeof field == Array? \" \": field}}\n          </td>\n          <td v-if=\"isLibrarian()\">\n            <router-link :to=\"'books/edit/' + book.id\"> Edit</router-link>\n          </td>\n          <td v-if=\"book.status !== 'RENTED'\">\n            <button @click=\"borrow(book.id)\" class=\"input-group-text\">Borrow</button>\n          </td>\n          <td v-if=\"book.status === 'RENTED' && isLibrarian()\">\n            <button @click=\"release(book.id)\" class=\"input-group-text\">Release</button>\n          </td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {Component, Vue} from \"vue-property-decorator\";\nimport BookService from \"@/services/BookService\";\nimport {namespace} from \"vuex-class\";\nimport BorrowingService from \"@/services/BorrowingService\";\n\nconst Auth = namespace(\"Auth\");\n\nclass BookDto {\n\n  id: number;\n  author: string;\n  title: string;\n  year: string;\n  status: string;\n  selectedStatus: string;\n  language: string;\n  categories: string;\n\n  constructor(\n      id: number,\n      author: string,\n      title: string,\n      year: string,\n      status: string,\n      selectedStatus: string,\n      language: string,\n      categories: string\n  ) {\n    this.id = id\n    this.author = author\n    this.title = title\n    this.year = year\n    this.status = status\n    this.selectedStatus = selectedStatus\n    this.language = language\n    this.categories = categories\n  }\n}\n\n@Component\nexport default class Home extends Vue {\n  @Auth.State(\"user\")\n  private currentUser!: any;\n  private content: BookDto[] = [];\n  private error = null;\n  private searchKey = \"\";\n\n  mounted() {\n    if (!this.currentUser) {\n      this.$router.push(\"/login\");\n    }\n    this.loadBooks();\n  }\n\n  loadBooks() {\n    BookService.searchBooks(this.searchKey, 20, 0).then(\n        (response) => {\n          this.content = response.data.content;\n        },\n        (error) => this.extractErrorMessage(error)\n    );\n  }\n\n  isLibrarian(): boolean {\n    if (this.currentUser && this.currentUser.authorities) {\n      return this.currentUser.authorities.includes(\"LIBRARIAN\");\n    }\n    return false;\n  }\n\n  borrow(bookId: number) {\n    BorrowingService.borrow({\n      bookId: bookId\n    }).then(\n        (response) => {\n          this.loadBooks();\n        },\n        (error) => this.extractErrorMessage(error)\n    );\n  }\n\n  release(bookId: number) {\n    BorrowingService.release({\n      bookId: bookId\n    }).then(\n        (response) => {\n          this.loadBooks();\n        },\n        (error) => this.extractErrorMessage(error)\n    );\n  }\n\n  private extractErrorMessage(error: any) {\n    this.error =\n        (error.response && error.response.data) ||\n        error.message ||\n        error.toString();\n  }\n}\n</script>\n"]}]}